{% extends 'base.html' %}
{% block content %}
<h2>Your Friends</h2>
<div style="margin-top:0.75rem;">
  <h4>Incoming requests</h4>
  {% for r in incoming %}
    <div class="card" style="display:flex;justify-content:space-between;align-items:center;">
      <div>{{ r.from_user.username }}</div>
      <div>
        <a class="btn btn-blue" href="{% url 'friend_accept' r.id %}">Accept</a>
      </div>
    </div>
  {% empty %}
    <p class="small">No incoming requests.</p>
  {% endfor %}
</div>

<div style="margin-top:1rem;">
  <h4>Your friends</h4>
  <div class="grid">
    {% for p in page_obj %}
      <div class="card">
        <div style="display:flex;align-items:center;gap:1rem;">
          <img src="{{ p.user.profile.photo.url|default:'/static/default-avatar.png' }}" class="avatar">
          <div>
            <div style="font-weight:600;">{{ p.user.username }}</div>
            <div class="small">{{ p.location }}</div>
          </div>
        </div>
        <div style="margin-top:0.75rem;display:flex;gap:0.5rem;">
          <a href="{% url 'profile_view_user' p.user.username %}" class="btn btn-blue">View</a>
          <a href="{% url 'friend_remove' p.user.id %}" class="btn btn-red">Remove</a>
        </div>
      </div>
    {% endfor %}
  </div>

  <div class="pager">
    {% if page_obj.has_previous %}<a href="?page={{ page_obj.previous_page_number }}">Previous</a>{% endif %}
    <div class="current">Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</div>
    {% if page_obj.has_next %}<a href="?page={{ page_obj.next_page_number }}">Next</a>{% endif %}
  </div>
</div>
{% endblock %}
